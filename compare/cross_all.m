mainFolder = '.';
subdirs = dir(mainFolder);
subdirs(~[subdirs.isdir]) = [];
tf = ismember( {subdirs.name}, {'.', '..', 'cross_all.m'});
subdirs(tf) = [];
numberOfFolders = length(subdirs); 
fileID = fopen('exp.txt','w');
for K = 1: numberOfFolders
    thissubdir = subdirs(K).name;
    subdirpath = [mainFolder '\' thissubdir];
    files = dir(subdirpath);  
    tr = ismember( {files.name}, {'.', '..'});
    files(tr) = [];
    arr = {files.name};
    Out = nchoosek(arr, 2);
    l = length(Out);
    for i=1:l
        %im1 = imread([subdirpath '\' Out{i,1}]);
        %im2 = imread([subdirpath '\' Out{i,2}]);
        im1 = imread([subdirpath '\' Out{1}]);
        im2 = imread([subdirpath '\' Out{2}]);
        res = ssim(im1, im2 );
        %fprintf(fileID, '%s:%s:%f \n', Out{i,1},Out{i,2},res);
        fprintf(fileID, '%s:%s:%f \n', Out{1},Out{2},res);
    end
    
end
fclose(fileID);